<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>calendar</title>
</head>
<style>
    #cTable {font-size: 3vw;padding: 1vw;border-collapse: collapse;
        margin-left: auto;margin-right: auto;margin-top: 2vh;}
    #cTable td {border: solid 0.2vw #797979;padding: 1vw;}
    #dayLabel td {border: solid 0.2vw #797979;padding: 0 1vw;width: 10vw;}
    .cNav, #startDate, #endDate {cursor: pointer;}
    #calendar {display: none;}
</style>
<body style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">

    <div id="setUp" style="text-align: center;">
        <h1>Setup your new meeting</h1>
       
        <label for="meetingName">Name of the meeting:</label>
        <input type="text" id="meetingName" name="meetingName">
        <h3 id="dateInput" onclick="displayCalendar('calendar')">
            &#x1F4C5;
            <span style="border: #797979 0.1vw solid;padding: 0.2vw;">
            <span id="startDate">&nbsp;
                Start on</span>&nbsp;-&nbsp;
            <span id="endDate">&nbsp;End on&nbsp;</span>
            </span>
        </h3>

    </div>


    <!--choose the date-->
    <div id="calendar">
    <h3>
        <button onclick="today('cTable')" style="vertical-align: middle;">
            Today
        </button>
        <span class="cNav" onclick="yearNav(-1)">&#8810;</span>
        <span class="cNav" onclick="monthNav(-1)">&lt;</span>
        <span class="cNav" onclick="monthNav(1)">&gt;</span>
        <span class="cNav" onclick="yearNav(1)">&#8811;</span>
        <span id="month"></span>
        <span id="year"></span>

    </h3>
    <table id="cTable">
        <tr id="dayLabel">
            <td>Sun</td><td>Mon</td><td>Tue</td>
            <td>Wed</td><td>Thu</td><td>Fri</td><td>Sat</td>
        </tr>
    </table>
    </div>


<script>
const monthLabel = ['January','February','March','April','May','June',
'July','August','September','October','November','December']
var nowMonth;
var nowYear;
var beginD;var endD;
var dRowCol = [['row','col']]
today('cTable');

function displayCalendar(id){
    document.getElementById(id).style.display = 'block'
}

function today(tableID){
    const now = new Date()  
    nowMonth = now.getMonth();
    nowYear = now.getFullYear();  
    var nowDate = now.getDate();
    clearCalendar(tableID)
    showCalendar(now);
    const nowRow = dRowCol[nowDate][0]
    const nowCol = dRowCol[nowDate][1]

    //change color of Today
    const week = document.getElementById(tableID).rows[nowRow].cells
    week[nowCol].style.color = 'red'
}

function monthNav(nav){
    nowMonth = nowMonth + nav;
    var newDate = new Date(nowYear, nowMonth)
    clearCalendar('cTable')
    showCalendar(newDate)
}

function yearNav(nav){
    nowYear = nowYear + nav
    let newDate = new Date(nowYear, nowMonth)
    clearCalendar('cTable')
    showCalendar(newDate)
}

function clearCalendar(tableID){
    const tab = document.getElementById(tableID)
    const weeksNumber = tab.rows.length
    for (let index = 0; index < weeksNumber-1; index++) {
        tab.deleteRow(1)
    }
}

function showCalendar(d){
    const year = d.getFullYear()
    const month = d.getMonth()
    document.getElementById('month').innerHTML = monthLabel[month]
    document.getElementById('year').innerHTML = year
    let wk=1;
    nextWeek('cTable')

    //date run
    for (let dte = 1; dte <= 31; dte++) {
        const today = new Date(year,month,dte)
        const day = today.getDay()
        const todate = today.getDate()
        if (todate!=dte){break}

        displayDate('cTable',wk,day,dte)  
        let toPush = [wk,day]
        dRowCol.push(toPush)

        //check if tommorrow still in the month
        const tomorrow = new Date(year,month,dte+1)
        const tomorrowDate = tomorrow.getDate()
        if (day==6 && tomorrowDate==dte+1){
            wk++
            nextWeek('cTable')
        } 
    }
}

function nextWeek(tableID){
    const cTable = document.getElementById(tableID)
    const wk = cTable.insertRow(-1)
    for (let index = 0; index < 7; index++) {
        const cell = wk.insertCell(index)  
    }
}

function displayDate(tableID,wk,col,date2Display){
    const week = document.getElementById(tableID).rows[wk].cells
    week[col].innerHTML = date2Display
    week[col].style.cursor = 'pointer'
    week[col].onclick = function(){
        showSelectedDate(tableID,wk,col,date2Display)
    }
}

function showSelectedDate(tableID,wk,col,date2Display){
    //highlight selected date
    const week = document.getElementById(tableID).rows[wk].cells
    week[col].style.background = 'darkblue'
    week[col].style.color = 'white'

    //update in the box
    const start = document.getElementById('startDate')
    const end = document.getElementById('endDate')

    if (beginD==null){
        start.innerHTML = date2Display + ' ' + monthLabel[nowMonth]+ ' ' + nowYear
        beginD = new Date(nowYear, nowMonth, date2Display)
    }
    else {
        newDate = new Date(nowYear, nowMonth, date2Display)
        console.log(newDate-beginD)
        if (newDate>beginD){
            endD = newDate;
            end.innerHTML = date2Display + ' ' + monthLabel[nowMonth]+ ' ' + nowYear
            //check if duration >2d
            dateDiff = date2Display-beginD.getDate()

            if (dateDiff>2){
                for (let index = 0; index < dateDiff; index++) {
                    
                }
            }
        }
    }
    
}

</script>
</body>
</html>